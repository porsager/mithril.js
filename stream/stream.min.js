!function(){"use strict";t.SKIP={},t.lift=function(){var n=arguments[0];return r(Array.prototype.slice.call(arguments,1)).map((function(t){return n.apply(void 0,t)}))},t.scan=function(n,e,r){var a=r.map((function(r){var a=n(e,r);return a!==t.SKIP&&(e=a),a}));return a(e),a},t.merge=r,t.combine=e,t.scanMerge=function(n,t){var r=n.map((function(n){return n[0]})),a=e((function(){var e=arguments[arguments.length-1];return r.forEach((function(r,a){e.indexOf(r)>-1&&(t=n[a][1](t,r()))})),t}),r);return a(t),a},t["fantasy-land/of"]=t;var n=!1;function t(n){var r,u=[],i=[];function o(e){return arguments.length&&e!==t.SKIP&&(n=e,a(o)&&(o._changing(),o._state="active",u.forEach((function(t,e){t(i[e](n))})))),n}return o.constructor=t,o._state=arguments.length&&n!==t.SKIP?"active":"pending",o._parents=[],o._changing=function(){a(o)&&(o._state="changing"),u.forEach((function(n){n._changing()}))},o._map=function(e,r){var a=r?t():t(e(n));return a._parents.push(o),u.push(a),i.push(e),a},o.map=function(n){return o._map(n,"active"!==o._state)},o.toJSON=function(){return null!=n&&"function"==typeof n.toJSON?n.toJSON():n},o["fantasy-land/map"]=o.map,o["fantasy-land/ap"]=function(n){return e((function(n,t){return n()(t())}),[n,o])},o._unregisterChild=function(n){var t=u.indexOf(n);-1!==t&&(u.splice(t,1),i.splice(t,1))},Object.defineProperty(o,"end",{get:function(){return r||((r=t()).map((function(n){return!0===n&&(o._parents.forEach((function(n){n._unregisterChild(o)})),o._state="ended",o._parents.length=u.length=i.length=0),n})),r)}}),o}function e(n,e){var r=e.every((function(n){if(n.constructor!==t)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream.");return"active"===n._state})),a=r?t(n.apply(null,e.concat([e]))):t(),u=[],i=e.map((function(t){return t._map((function(i){return u.push(t),(r||e.every((function(n){return"pending"!==n._state})))&&(r=!0,a(n.apply(null,e.concat([u]))),u=[]),i}),!0)})),o=a.end.map((function(n){!0===n&&(i.forEach((function(n){n.end(!0)})),o.end(!0))}));return a}function r(n){return e((function(){return n.map((function(n){return n()}))}),n)}function a(n){return"pending"===n._state||"active"===n._state||"changing"===n._state}Object.defineProperty(t,"HALT",{get:function(){return n||console.log("HALT is deprecated and has been renamed to SKIP"),n=!0,t.SKIP}}),"undefined"!=typeof module?module.exports=t:"function"!=typeof window.m||"stream"in window.m?window.m={stream:t}:window.m.stream=t}();